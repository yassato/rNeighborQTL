<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>rNeighborQTL</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">rNeighborQTL</h1>



<div id="overview" class="section level2">
<h2>Overview</h2>
<p>
The “rNeighborQTL” package includes core functions to perform QTL mapping of neighbor effects. Taking conditional genotype probabilities from the “R/qtl” package (Broman et al. 2003), the “scan_neighbor()” calculates neighbor genotypic identity and performs interval mapping of neighbor QTL effects. The neighbor QTL requires spatial information, namely individual positions along the x- and y-axes, in addition to the genotype and phenotype data. See Sato, Takeda &amp; Nagano (2020) for the theoretical background.
</p>
</div>
<div id="input-files" class="section level2">
<h2>Input files</h2>
<p>
First, let us prepare input data using the “R/qtl” package (Broman et al. 2003). Here is an example to import .csv files into a ‘cross’ object and calculate conditional self-genotype probabilities. In this example, we import insect herbivory data on Col x Kas recombinant inbred lines (RILs) of <em>Arabidopsis thaliana</em> (Wilson et al. 2001; Sato, Takeda &amp; Nagano 2020).
</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>colkas &lt;-<span class="st"> </span>qtl<span class="op">::</span><span class="kw">read.cross</span>(<span class="dt">format=</span><span class="st">&quot;csvs&quot;</span>,<span class="dt">dir=</span><span class="st">&quot;../inst&quot;</span>,</span>
<span id="cb1-2"><a href="#cb1-2"></a>                          <span class="dt">genfile=</span><span class="st">&quot;ColKas_geno.csv&quot;</span>,</span>
<span id="cb1-3"><a href="#cb1-3"></a>                          <span class="dt">phefile =</span> <span class="st">&quot;ColKas_pheno.csv&quot;</span>,</span>
<span id="cb1-4"><a href="#cb1-4"></a>                          <span class="dt">na.strings =</span> <span class="kw">c</span>(<span class="st">&quot;_&quot;</span>), <span class="dt">estimate.map=</span><span class="ot">TRUE</span>, <span class="dt">crosstype =</span> <span class="st">&quot;riself&quot;</span></span>
<span id="cb1-5"><a href="#cb1-5"></a>                          )</span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="co">#&gt;  --Read the following data:</span></span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="co">#&gt;   126  individuals</span></span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="co">#&gt;   26  markers</span></span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="co">#&gt;   10  phenotypes</span></span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="co">#&gt;  --Estimating genetic map</span></span>
<span id="cb1-11"><a href="#cb1-11"></a><span class="co">#&gt;  --Cross type: riself</span></span>
<span id="cb1-12"><a href="#cb1-12"></a></span>
<span id="cb1-13"><a href="#cb1-13"></a>colkas_genoprob &lt;-<span class="st"> </span>qtl<span class="op">::</span><span class="kw">calc.genoprob</span>(colkas, <span class="dt">step=</span><span class="dv">2</span>)</span></code></pre></div>
</div>
<div id="proportion-of-variation-explained-by-neighbor-effects" class="section level2">
<h2>Proportion of variation explained by neighbor effects</h2>
<p>
Prior to the genome scan, we estimate the ‘scale’ argument. Using linear mixed models implemented in the “gaston” package (Perdry &amp; Dandine-Roulland 2020), the “calc_pve()” computes proportion of phenotypic variation (PVE) by neighbor effects for a series of spatial scales. Based on the PVE, we calculate <span class="math inline">\(\Delta\)</span>PVE metric and seek the scale <span class="math inline">\(s\)</span> that gives an argument for the maximum of <span class="math inline">\(\Delta\)</span>PVE.
</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="kw">library</span>(rNeighborQTL)</span>
<span id="cb2-2"><a href="#cb2-2"></a>x &lt;-<span class="st"> </span>colkas<span class="op">$</span>pheno[,<span class="dv">2</span>]</span>
<span id="cb2-3"><a href="#cb2-3"></a>y &lt;-<span class="st"> </span>colkas<span class="op">$</span>pheno[,<span class="dv">3</span>]</span>
<span id="cb2-4"><a href="#cb2-4"></a>smap_colkas &lt;-<span class="st"> </span><span class="kw">data.frame</span>(x,y)</span>
<span id="cb2-5"><a href="#cb2-5"></a></span>
<span id="cb2-6"><a href="#cb2-6"></a>s_seq &lt;-<span class="st"> </span><span class="kw">quantile</span>(<span class="kw">dist</span>(smap_colkas),<span class="kw">c</span>(<span class="fl">0.1</span><span class="op">*</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>)))</span>
<span id="cb2-7"><a href="#cb2-7"></a>colkas_pve &lt;-<span class="st"> </span><span class="kw">calc_pve</span>(<span class="dt">genoprobs=</span>colkas_genoprob,</span>
<span id="cb2-8"><a href="#cb2-8"></a>                       <span class="dt">pheno=</span><span class="kw">log</span>(colkas<span class="op">$</span>pheno[,<span class="dv">5</span>]<span class="op">+</span><span class="dv">1</span>),</span>
<span id="cb2-9"><a href="#cb2-9"></a>                       <span class="dt">smap=</span>smap_colkas, <span class="dt">s_seq=</span>s_seq,</span>
<span id="cb2-10"><a href="#cb2-10"></a>                       <span class="dt">addcovar=</span><span class="kw">as.matrix</span>(colkas<span class="op">$</span>pheno[,<span class="dv">7</span><span class="op">:</span><span class="dv">9</span>]) </span>
<span id="cb2-11"><a href="#cb2-11"></a>                       )</span>
<span id="cb2-12"><a href="#cb2-12"></a><span class="co">#&gt; scale = 2.236</span></span>
<span id="cb2-13"><a href="#cb2-13"></a><span class="co">#&gt; scale = 3.162</span></span>
<span id="cb2-14"><a href="#cb2-14"></a><span class="co">#&gt; scale = 4.243</span></span>
<span id="cb2-15"><a href="#cb2-15"></a><span class="co">#&gt; scale = 5.099</span></span>
<span id="cb2-16"><a href="#cb2-16"></a><span class="co">#&gt; scale = 6</span></span>
<span id="cb2-17"><a href="#cb2-17"></a><span class="co">#&gt; scale = 7</span></span>
<span id="cb2-18"><a href="#cb2-18"></a><span class="co">#&gt; scale = 7.81</span></span>
<span id="cb2-19"><a href="#cb2-19"></a><span class="co">#&gt; scale = 8.602</span></span>
<span id="cb2-20"><a href="#cb2-20"></a><span class="co">#&gt; scale = 10.05</span></span>
<span id="cb2-21"><a href="#cb2-21"></a><span class="co">#&gt; scale = 15</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="estimation-of-qtl-effects" class="section level2">
<h2>Estimation of QTL effects</h2>
<p>
Similar to Haley-Knott regression (Haley &amp; Knott 1992), the additive and dominance deviation <span class="math inline">\(a\)</span> and <span class="math inline">\(d\)</span> are estimated using a linear or quadratic regression on neighbor genotypic identity. The “eff_neighbor()” estimates the coefficients for self and neighbor effects, and plots the results as follows.
</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>colkas_eff &lt;-<span class="st"> </span><span class="kw">eff_neighbor</span>(<span class="dt">genoprobs=</span>colkas_genoprob,</span>
<span id="cb3-2"><a href="#cb3-2"></a>                           <span class="dt">pheno=</span><span class="kw">log</span>(colkas<span class="op">$</span>pheno[,<span class="dv">5</span>]<span class="op">+</span><span class="dv">1</span>),</span>
<span id="cb3-3"><a href="#cb3-3"></a>                           <span class="dt">smap=</span>smap_colkas, <span class="dt">scale=</span><span class="dv">7</span>,</span>
<span id="cb3-4"><a href="#cb3-4"></a>                           <span class="dt">addcovar=</span><span class="kw">as.matrix</span>(colkas<span class="op">$</span>pheno[,<span class="dv">7</span><span class="op">:</span><span class="dv">9</span>])</span>
<span id="cb3-5"><a href="#cb3-5"></a>                           )</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="lod-score" class="section level2">
<h2>LOD score</h2>
<p>
Lastly, we perform a genome scan to obtain LOD scores for neighbor QTL effects. The “scan_neighbor()” calculates likelihoods using the estimated QTL effects through the “eff_neighbor()”. The results are drawn by “plot_nei()”.
</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>colkas_scan &lt;-<span class="st"> </span><span class="kw">scan_neighbor</span>(<span class="dt">genoprobs=</span>colkas_genoprob, </span>
<span id="cb4-2"><a href="#cb4-2"></a>                             <span class="dt">pheno=</span><span class="kw">log</span>(colkas<span class="op">$</span>pheno[,<span class="dv">5</span>]<span class="op">+</span><span class="dv">1</span>),</span>
<span id="cb4-3"><a href="#cb4-3"></a>                             <span class="dt">smap=</span>smap_colkas, <span class="dt">scale=</span><span class="dv">7</span>, </span>
<span id="cb4-4"><a href="#cb4-4"></a>                             <span class="dt">addcovar=</span><span class="kw">as.matrix</span>(colkas<span class="op">$</span>pheno[,<span class="dv">7</span><span class="op">:</span><span class="dv">9</span>])</span>
<span id="cb4-5"><a href="#cb4-5"></a>                             )</span>
<span id="cb4-6"><a href="#cb4-6"></a><span class="kw">plot_nei</span>(colkas_scan)</span></code></pre></div>
<img src="data:image/png;base64,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" /><!-- -->
<p>
In addition to the genome scan, we can perform permutation tests to estimate a genome-wide significance level. Such permutation tests better account data structure, but require much computational time. This is an example code for 3-times permutations.
</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>colkas_perm &lt;-<span class="st"> </span><span class="kw">perm_neighbor</span>(<span class="dt">genoprobs=</span>colkas_genoprob, </span>
<span id="cb5-2"><a href="#cb5-2"></a>                             <span class="dt">pheno=</span><span class="kw">log</span>(colkas<span class="op">$</span>pheno[,<span class="dv">5</span>]<span class="op">+</span><span class="dv">1</span>),</span>
<span id="cb5-3"><a href="#cb5-3"></a>                             <span class="dt">smap=</span>smap_colkas, <span class="dt">scale=</span><span class="dv">7</span>,</span>
<span id="cb5-4"><a href="#cb5-4"></a>                             <span class="dt">addcovar=</span><span class="kw">as.matrix</span>(colkas<span class="op">$</span>pheno[,<span class="dv">6</span><span class="op">:</span><span class="dv">8</span>]),</span>
<span id="cb5-5"><a href="#cb5-5"></a>                             <span class="dt">times=</span><span class="dv">3</span>, <span class="dt">p_val=</span><span class="kw">c</span>(<span class="fl">0.5</span>,<span class="fl">0.1</span>)</span>
<span id="cb5-6"><a href="#cb5-6"></a>                             )</span></code></pre></div>
</div>
<div id="extensions" class="section level2">
<h2>Extensions</h2>
<div id="self-genotype-effects" class="section level3">
<h3><em>1. Self-genotype effects</em></h3>
<p>
The “scan_neighbor()” also provides LOD scores for self QTL effects. This gives the same results as the Haley-Knott regression of standard QTL mapping.
</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="kw">plot_nei</span>(colkas_scan, <span class="dt">type=</span><span class="st">&quot;self&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>colkas_scanone &lt;-<span class="st"> </span>qtl<span class="op">::</span><span class="kw">scanone</span>(colkas_genoprob,</span>
<span id="cb7-2"><a href="#cb7-2"></a>                            <span class="dt">pheno.col=</span><span class="kw">log</span>(colkas<span class="op">$</span>pheno<span class="op">$</span>holes<span class="op">+</span><span class="dv">1</span>),</span>
<span id="cb7-3"><a href="#cb7-3"></a>                            <span class="dt">addcovar=</span><span class="kw">as.matrix</span>(colkas<span class="op">$</span>pheno[,<span class="dv">7</span><span class="op">:</span><span class="dv">9</span>]),</span>
<span id="cb7-4"><a href="#cb7-4"></a>                            <span class="dt">method=</span><span class="st">&quot;hk&quot;</span>)</span>
<span id="cb7-5"><a href="#cb7-5"></a><span class="kw">plot</span>(colkas_scanone)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="composite-interval-mapping" class="section level3">
<h3><em>2. Composite interval mapping</em></h3>
<p>
The “addQTL” argument allows us to include non-focal QTLs as covariates. This option enables composite interval mapping (Jensen et al. 1993) that considers additional QTL effects. Here is an example code using the Col x Kas herbivory data, with the nga8 marker considered a covariate.
</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>colkas_cim &lt;-<span class="st"> </span><span class="kw">scan_neighbor</span>(<span class="dt">genoprobs=</span>colkas_genoprob, </span>
<span id="cb8-2"><a href="#cb8-2"></a>                            <span class="dt">pheno=</span><span class="kw">log</span>(colkas<span class="op">$</span>pheno[,<span class="dv">5</span>]<span class="op">+</span><span class="dv">1</span>),</span>
<span id="cb8-3"><a href="#cb8-3"></a>                            <span class="dt">smap=</span>smap_colkas, <span class="dt">scale=</span><span class="dv">7</span>,</span>
<span id="cb8-4"><a href="#cb8-4"></a>                            <span class="dt">addcovar=</span><span class="kw">as.matrix</span>(colkas<span class="op">$</span>pheno[,<span class="dv">7</span><span class="op">:</span><span class="dv">9</span>]),</span>
<span id="cb8-5"><a href="#cb8-5"></a>                            <span class="dt">addQTL=</span><span class="st">&quot;c4_nga8&quot;</span></span>
<span id="cb8-6"><a href="#cb8-6"></a>                            )</span>
<span id="cb8-7"><a href="#cb8-7"></a><span class="kw">plot_nei</span>(colkas_cim)</span></code></pre></div>
</div>
<div id="epistasis-in-neighbor-qtl-effects" class="section level3">
<h3><em>3. Epistasis in neighbor QTL effects</em></h3>
<p>
For the analysis of epistasis, the “int_neighbor()” calculate LOD score of two-way interactions between a focal marker and the others. Here is an example code for the ‘nga8’ marker in the Col x Kas herbivory data.
</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>colkas_int &lt;-<span class="st"> </span><span class="kw">int_neighbor</span>(<span class="dt">genoprobs=</span>colkas_genoprob, </span>
<span id="cb9-2"><a href="#cb9-2"></a>                           <span class="dt">pheno=</span><span class="kw">log</span>(colkas<span class="op">$</span>pheno[,<span class="dv">5</span>]<span class="op">+</span><span class="dv">1</span>), </span>
<span id="cb9-3"><a href="#cb9-3"></a>                           <span class="dt">smap=</span>smap_colkas, <span class="dt">scale=</span><span class="dv">7</span>, </span>
<span id="cb9-4"><a href="#cb9-4"></a>                           <span class="dt">addcovar=</span><span class="kw">as.matrix</span>(colkas<span class="op">$</span>pheno[,<span class="dv">7</span><span class="op">:</span><span class="dv">9</span>]), </span>
<span id="cb9-5"><a href="#cb9-5"></a>                           <span class="dt">addQTL=</span><span class="st">&quot;c4_nga8&quot;</span>, <span class="dt">intQTL=</span><span class="st">&quot;c4_nga8&quot;</span></span>
<span id="cb9-6"><a href="#cb9-6"></a>                           )</span>
<span id="cb9-7"><a href="#cb9-7"></a></span>
<span id="cb9-8"><a href="#cb9-8"></a><span class="kw">plot_nei</span>(colkas_int, <span class="dt">type=</span><span class="st">&quot;int&quot;</span>)</span></code></pre></div>
</div>
<div id="binary-traits" class="section level3">
<h3><em>4. Binary traits</em></h3>
<p>
The “response” argument allows us to analyze “binary” phenotypes as well as “quantitative” traits. This argument calls logistic (mixed) models internally (Faraway 2016; Chen et al. 2016). The “calc_pve()” yields the ratio of phenotypic variation explained (RVE) by neighbor effects as RVE<sub>nei</sub> =<span class="math inline">\(\sigma^2_2/\sigma^2_1\)</span> when “binary” traits are analyzed, because the logistic mixed model does not compute <span class="math inline">\(\sigma^2_e\)</span> (Perdry &amp; Dandine-Roulland 2020). Here is an example code for the analysis of the presence or absence of bolting in Col x Kas RILs.
</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>s_seq &lt;-<span class="st"> </span><span class="kw">quantile</span>(<span class="kw">dist</span>(smap_colkas),<span class="kw">c</span>(<span class="fl">0.1</span><span class="op">*</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>)))</span>
<span id="cb10-2"><a href="#cb10-2"></a>colkas_pveBin &lt;-<span class="st"> </span><span class="kw">calc_pve</span>(<span class="dt">genoprobs=</span>colkas_genoprob, </span>
<span id="cb10-3"><a href="#cb10-3"></a>                          <span class="dt">pheno=</span>colkas<span class="op">$</span>pheno[,<span class="dv">7</span>],</span>
<span id="cb10-4"><a href="#cb10-4"></a>                          <span class="dt">smap=</span>smap_colkas, <span class="dt">s_seq=</span>s_seq,</span>
<span id="cb10-5"><a href="#cb10-5"></a>                          <span class="dt">response=</span><span class="st">&quot;binary&quot;</span>, <span class="dt">addcovar=</span><span class="kw">as.matrix</span>(colkas<span class="op">$</span>pheno[,<span class="dv">8</span><span class="op">:</span><span class="dv">9</span>]), </span>
<span id="cb10-6"><a href="#cb10-6"></a>                          <span class="dt">fig=</span><span class="ot">TRUE</span>)</span>
<span id="cb10-7"><a href="#cb10-7"></a><span class="co">#&gt; scale = 2.236</span></span>
<span id="cb10-8"><a href="#cb10-8"></a><span class="co">#&gt; scale = 3.162</span></span>
<span id="cb10-9"><a href="#cb10-9"></a><span class="co">#&gt; scale = 4.243</span></span>
<span id="cb10-10"><a href="#cb10-10"></a><span class="co">#&gt; scale = 5.099</span></span>
<span id="cb10-11"><a href="#cb10-11"></a><span class="co">#&gt; scale = 6</span></span>
<span id="cb10-12"><a href="#cb10-12"></a><span class="co">#&gt; scale = 7</span></span>
<span id="cb10-13"><a href="#cb10-13"></a><span class="co">#&gt; scale = 7.81</span></span>
<span id="cb10-14"><a href="#cb10-14"></a><span class="co">#&gt; scale = 8.602</span></span>
<span id="cb10-15"><a href="#cb10-15"></a><span class="co">#&gt; scale = 10.05</span></span>
<span id="cb10-16"><a href="#cb10-16"></a><span class="co">#&gt; scale = 15</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a></span>
<span id="cb11-2"><a href="#cb11-2"></a>colkas_scanBin &lt;-<span class="st"> </span><span class="kw">scan_neighbor</span>(<span class="dt">genoprobs=</span>colkas_genoprob, </span>
<span id="cb11-3"><a href="#cb11-3"></a>                                <span class="dt">pheno=</span>colkas<span class="op">$</span>pheno[,<span class="dv">7</span>],</span>
<span id="cb11-4"><a href="#cb11-4"></a>                                <span class="dt">smap=</span>smap_colkas, <span class="dt">scale=</span><span class="fl">2.24</span>,</span>
<span id="cb11-5"><a href="#cb11-5"></a>                                <span class="dt">addcovar=</span><span class="kw">as.matrix</span>(colkas<span class="op">$</span>pheno[,<span class="dv">8</span><span class="op">:</span><span class="dv">9</span>]), </span>
<span id="cb11-6"><a href="#cb11-6"></a>                                <span class="dt">response=</span><span class="st">&quot;binary&quot;</span>)</span>
<span id="cb11-7"><a href="#cb11-7"></a></span>
<span id="cb11-8"><a href="#cb11-8"></a><span class="kw">plot_nei</span>(colkas_scanBin)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="crossing-design" class="section level3">
<h3><em>5. Crossing design</em></h3>
<p>
The neighbor QTL package is able to handle AB heterozygotes. It also works even when there are only AA or AB genotypes. However, sex chromosomes are not supported currently, and should be excluded before the genome scan. This is a simulation using F2 or backcross lines implemented in the “R/qtl” package.
</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="co">#F2 lines</span></span>
<span id="cb12-2"><a href="#cb12-2"></a><span class="kw">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb12-3"><a href="#cb12-3"></a><span class="kw">data</span>(<span class="st">&quot;fake.f2&quot;</span>,<span class="dt">package=</span><span class="st">&quot;qtl&quot;</span>)</span>
<span id="cb12-4"><a href="#cb12-4"></a>fake_f2 &lt;-<span class="st"> </span><span class="kw">subset</span>(fake.f2, <span class="dt">chr=</span><span class="dv">1</span><span class="op">:</span><span class="dv">19</span>)</span>
<span id="cb12-5"><a href="#cb12-5"></a>smap_f2 &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">runif</span>(qtl<span class="op">::</span><span class="kw">nind</span>(fake_f2),<span class="dv">1</span>,<span class="dv">100</span>),<span class="kw">runif</span>(qtl<span class="op">::</span><span class="kw">nind</span>(fake_f2),<span class="dv">1</span>,<span class="dv">100</span>))</span>
<span id="cb12-6"><a href="#cb12-6"></a>genoprobs_f2 &lt;-<span class="st"> </span>qtl<span class="op">::</span><span class="kw">calc.genoprob</span>(fake_f2,<span class="dt">step=</span><span class="dv">2</span>)</span>
<span id="cb12-7"><a href="#cb12-7"></a>s_seq &lt;-<span class="st"> </span><span class="kw">quantile</span>(<span class="kw">dist</span>(smap_f2),<span class="kw">c</span>(<span class="fl">0.1</span><span class="op">*</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>)))</span>
<span id="cb12-8"><a href="#cb12-8"></a></span>
<span id="cb12-9"><a href="#cb12-9"></a>nei_eff &lt;-<span class="st"> </span><span class="kw">sim_nei_qtl</span>(genoprobs_f2, <span class="dt">a2=</span><span class="fl">0.5</span>, <span class="dt">d2=</span><span class="fl">0.5</span>, </span>
<span id="cb12-10"><a href="#cb12-10"></a>                       <span class="dt">smap=</span>smap_f2, </span>
<span id="cb12-11"><a href="#cb12-11"></a>                       <span class="dt">scale=</span>s_seq[<span class="dv">1</span>], <span class="dt">n_QTL=</span><span class="dv">1</span></span>
<span id="cb12-12"><a href="#cb12-12"></a>                       )</span>
<span id="cb12-13"><a href="#cb12-13"></a></span>
<span id="cb12-14"><a href="#cb12-14"></a>pve_f2 &lt;-<span class="st"> </span><span class="kw">calc_pve</span>(<span class="dt">genoprobs=</span>genoprobs_f2,</span>
<span id="cb12-15"><a href="#cb12-15"></a>                   <span class="dt">pheno=</span>nei_eff<span class="op">$</span>nei_y,</span>
<span id="cb12-16"><a href="#cb12-16"></a>                   <span class="dt">smap=</span>smap_f2, <span class="dt">s_seq=</span>s_seq[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>],</span>
<span id="cb12-17"><a href="#cb12-17"></a>                   <span class="dt">addcovar=</span><span class="kw">as.matrix</span>(<span class="kw">cbind</span>(fake_f2<span class="op">$</span>pheno<span class="op">$</span>sex,fake_f2<span class="op">$</span>pheno<span class="op">$</span>pgm)),</span>
<span id="cb12-18"><a href="#cb12-18"></a>                   <span class="dt">fig=</span><span class="ot">FALSE</span>)</span>
<span id="cb12-19"><a href="#cb12-19"></a><span class="co">#&gt; scale = 19.368</span></span>
<span id="cb12-20"><a href="#cb12-20"></a><span class="co">#&gt; scale = 28.245</span></span>
<span id="cb12-21"><a href="#cb12-21"></a><span class="co">#&gt; scale = 35.695</span></span>
<span id="cb12-22"><a href="#cb12-22"></a><span class="co">#&gt; scale = 42.909</span></span>
<span id="cb12-23"><a href="#cb12-23"></a><span class="co">#&gt; scale = 49.961</span></span>
<span id="cb12-24"><a href="#cb12-24"></a>    </span>
<span id="cb12-25"><a href="#cb12-25"></a>deltaPVE &lt;-<span class="st"> </span>pve_f2[,<span class="dv">2</span>] <span class="op">-</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,pve_f2[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,<span class="dv">2</span>])</span>
<span id="cb12-26"><a href="#cb12-26"></a><span class="co">#&gt; Warning in pve_f2[, 2] - c(0, pve_f2[1:4, 2]): 長いオブジェクトの長さが短いオブ</span></span>
<span id="cb12-27"><a href="#cb12-27"></a><span class="co">#&gt; ジェクトの長さの倍数になっていません</span></span>
<span id="cb12-28"><a href="#cb12-28"></a>argmax_s &lt;-<span class="st"> </span>s_seq[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>][deltaPVE<span class="op">==</span><span class="kw">max</span>(deltaPVE)]</span>
<span id="cb12-29"><a href="#cb12-29"></a>    </span>
<span id="cb12-30"><a href="#cb12-30"></a>scan_f2 &lt;-<span class="st"> </span><span class="kw">scan_neighbor</span>(<span class="dt">genoprobs=</span>genoprobs_f2,</span>
<span id="cb12-31"><a href="#cb12-31"></a>                         <span class="dt">pheno=</span>nei_eff<span class="op">$</span>nei_y,</span>
<span id="cb12-32"><a href="#cb12-32"></a>                         <span class="dt">smap=</span>smap_f2, <span class="dt">scale=</span>argmax_s,</span>
<span id="cb12-33"><a href="#cb12-33"></a>                         <span class="dt">addcovar=</span><span class="kw">as.matrix</span>(<span class="kw">cbind</span>(fake_f2<span class="op">$</span>pheno<span class="op">$</span>sex,fake_f2<span class="op">$</span>pheno<span class="op">$</span>pgm))</span>
<span id="cb12-34"><a href="#cb12-34"></a>                         )</span>
<span id="cb12-35"><a href="#cb12-35"></a>    </span>
<span id="cb12-36"><a href="#cb12-36"></a><span class="kw">plot_nei</span>(scan_f2)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAYAAAAGACAMAAACTGUWNAAAAk1BMVEUAAAAAADoAAGYAAP8AOjoAOmYAOpAAZrYA//86AAA6ADo6OgA6OpA6ZpA6ZrY6kNtmAABmOgBmOjpmkLZmkNtmtttmtv+QOgCQZjqQtpCQ29uQ2/+2ZgC2Zjq227a22/+2//++vr7bkDrbtmbbtpDb29vb2//b////AAD/AP//tmb/25D/27b//wD//7b//9v///8KidYuAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAJmklEQVR4nO2d63qjNhgGyZ6StLtNum03beM2G/eQxN7G3P/VlYPAAhswIHglM/Mjj4NlCTQI6QPJjmKQEql3YOkgQAwCxCBADALEIEAMAsQgQAwCxCBADALEIEAMAsQgQAwCxCBADALEIEAMAsQgQAwCxCBADALEIEAMAsQgQAwCxCBADALEIEAMAsQgQEzwAnZ30YenypZ1dHFfvF5Fb77Ovku9QICY4AUcgoCJSCr29z+i6H1Wu7vk1cUPT2UL2GXvZPVtp0s2/Pk5ij49ZDn8nbx899NTntdvP0ZvHoSHYwhKQE56fr/eZi/ffzUCkr/pO9/nAnLSc39lvS7eSH2ty1dqwhLw/iH9e5Od2Q/x9jp5mQvYRNHl024VGQEf9unS138l78Zp8iRlvj1P84/6kOLQBHzJqvEybQA32ZY3X3MB+bU+2ZwL+BKbJKu8P8jeNv3Bap/GB4ISYC4+l6mF4nKUCSiGQkUfUKQrKn1dJCyysTtqLWEK2ERVAXltHxVQVnqRZpOe/AgYQLUFFFcQWsBsWBVbnM1xMQyt9gG2gMzUkT4AAb2pVuzFL/G32/Lkr46CKgLeHB8FIaA3dsWaOCDZcCwOqAhoiAMQ0Bu7YuNvv17nAa4VCX98ONYH1CPhn/d5+UBAAk5g5UVw24szEZBcan4wQVpgnImATRkXqPekL2ciIP72OekTLj55cHuzJ+ciIFgQIAYBYhAgBgFiECAGAWIQIAYBYhAgBgFiECAGAWIQIAYBYhAgBgFiECAGAWIQIAYBYhAgBgFiECAGAWIQIAYBYhwLiMCgEuA2u3BBgBgEiEGAGASIQYAYBIhBgBtehn4QAW5AgBgEiEGAGASIeRlqAAFuQIAYBIhBgBgEiEGAGASIQYAYBIhBgBjfBOTfjxo1/y4IAgzTCFhn39ofp19SeOMguwDwS8Durqz2dcMXpCLAMImA19vyVyc2DRchBBhoAW7wS0DSB5gmQB/QxUSjIPOt8c1fkY0AA3GAG0IR0H9afCD4JeD1Nr3ybwjETmA6Adn4xxqQDs8uBPwTYKqeYWgHkwnYXmcCCMQ6oAW4wTcB6TjnMi6645HZhYBfAuLMwcV9cyCMgAICMTcgQAwCxCBADALEIEAMAsQgQAwCxCBADALEIEAMAsQgQAwCxCBADALEIEDLy+Bv62CFjBN8E7C4FTKeCVje+gDPBCxvhYxnAmgBp8MKGSf4JmBxK2S8EzB3dmqCEXCuK2TmFZBcXz48rZpmfVqYKeqjyg2DWQVsLu6TsU3jvOd43wO0xMIIMPQXkI4x08HluvE2Qzn4oQV0019AGmWlAppCLJMoHf8goJvhLWDVOMTMWF3cI+AEBvcBZazVxDq6QUA3A0dBUbr+pYPt9bsFCRhqYMo4YHfX3EoQYBjWB4wHAYZho6DxIMAwpBNuG386LzcM5m0B7TGu43LDwM9OeMbs1CBAzLwCttcnxQFuyg2DeTvh7E5bZyTsqNwwUMQBTY/bHZcbBoo4YNxoFAEGWoAT6APEMAoSQxwgBgFi5hWQPoxs/jIyx+WGwawC8ofBr7eXLamXt0DDrzhggQs0BHFAs4AlTk+f8RKURwDb67aZcctboOFVHEALOB0WaDjBNwELXKAxo4B0XvS6pW7dlhsGc8cB2+vLeNUWBzTmcrYLNOaNAzbJNb77ecCmpatGgGGYgFVS+W3rA+JVFN1sPz4t5idM5r0EXaaz/1tvRaR3K1bZ2c8wtINBnXByZdndtdR/dt5vv0sFEIh1MMkwNF8/tvs3pgV0MlEgVpz3S/kJE98ExOt8+LNpfHCMAANPxJyAADEIEDP/+oBxd4IQUNJbwCrvV9c8lLeZT8CmuLvTsgbYablhMJsAKwAedDe0f7lhMJsAK7BqvRnnrtwwmFFA5+N2x+WGAQLEIEAMAsTMKKDzy8gclxsG3IoQgwAx807O5V7QATMKMDeBuBdUgXtBYl7ioXPNRtwLarsKLW6FzODZftPEActbIeOXgAWuD5hLwGmXoCWukJmpDzitE15gCxj8yWmGoUtcITOQiQKxBa6QGQi3IlwwvP7nFnCmK2QkAlqfB6yTKs6nryxiFOSdgHRubr6CAwEdTCIgH4bu7lp+6AQBhkkEFIFYEqshoIMJW0CcTt5CQAcT9QHmvSQcQEA7Ez2UL0Lh3R0C2iEQcwECxCBAy5jAHgHjGXVrBQHjQYAYBKihD1DDKEgMAsQgQAwCxCBADALEIEAMAsQgQIx/Aha2QMM7AUtboOGbgMVNT/dNwNIWaIyof1qAC7wTsLQFGv4JWNgCDQ8FzJ2dloAEnOcCjYAETJWdlBcEaPFPwAlTeBFgmKYFNE6KHpad53goIG79iZn+2fmNjwJafjtjUHZe46WAmbOTggAxCBCDADEIEDOm/hHgAARoGVX/CBgPAsQgQAwCxCBADALEIEDK2MfbCBjH6AkGCBgHAsQgQA19gMkv1KleZyIg3Ml25yQgSAXnJSBAA34JGFyFV84FzGXTKwFFHZYH/3xKRaQfunLZDST5PLtuT425TTYz7tRlqvaRRhZ5PVSrtdhcOZry/9zD/lBfrA8d34f8nSLXaoZHBKRb3toJmrJPtj3u365ll76wS2vYucNMT02Ycvoy1f2+VWq+wJyJ1t96skr/e3V1dZiHvcX2dyTTWp3t3ZQp39Yztj5V2DjYx6P/TimgxyI9+1iL/bI2HFRkpXKOHE/Xx+rF1Hlu2H56ZtbLx8dqsvqHJhPQvEz1sPyjO1U9Y49WSf1UrJTw0llnj7XKKXh+fm4sspHKcfxnb6/mXf/QZAL6LFMtdsfeqfKdahor4dFrxz5t3xZQvazXizxeYrXserL61aiSwRx9QJ9lquW+NheeH2eRxD64g8/VjrzctM+jko2VpJLT/s1KdVbasP0Ba8PB5rZjnGgUtKxlqmPwKg5YIggQgwAxCBAjEwAGkQDoCwLEIEAMAsQgQAwCxCBADALEIEAMAsQgQAwCxCBADALEIEAMAsQgQAwCxCBADALEIEAMAsQgQAwCxCBADALEIEAMAsQgQAwCxCBADALEIEAMAsQgQAwCxCBADALEIEAMAsQgQAwCxCBADALEIEAMAsQgQAwCxCBADALEIEAMAsQgQAwCxCBADALEIEAMAsQgQAwCxCBADALEIEAMAsQgQAwCxCBADALEIEAMAsQgQAwCxCBADALEIEAMAsQgQAwCxCBADALEIEAMAsQgQAwCxCBADALEIEAMAsQgQAwCxCBADALEIEAMAsQgQAwCxCBAzP/S3KEb9g77WwAAAABJRU5ErkJggg==" /><!-- --></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="co">#backcross lines</span></span>
<span id="cb13-2"><a href="#cb13-2"></a><span class="kw">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb13-3"><a href="#cb13-3"></a><span class="kw">data</span>(<span class="st">&quot;fake.bc&quot;</span>,<span class="dt">package=</span><span class="st">&quot;qtl&quot;</span>)</span>
<span id="cb13-4"><a href="#cb13-4"></a>fake_bc &lt;-<span class="st"> </span><span class="kw">subset</span>(fake.bc, <span class="dt">chr=</span><span class="dv">1</span><span class="op">:</span><span class="dv">19</span>)</span>
<span id="cb13-5"><a href="#cb13-5"></a>smap_bc &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">runif</span>(qtl<span class="op">::</span><span class="kw">nind</span>(fake_bc),<span class="dv">1</span>,<span class="dv">100</span>),<span class="kw">runif</span>(qtl<span class="op">::</span><span class="kw">nind</span>(fake_bc),<span class="dv">1</span>,<span class="dv">100</span>))</span>
<span id="cb13-6"><a href="#cb13-6"></a>genoprobs_bc &lt;-<span class="st"> </span>qtl<span class="op">::</span><span class="kw">calc.genoprob</span>(fake_bc,<span class="dt">step=</span><span class="dv">2</span>)</span>
<span id="cb13-7"><a href="#cb13-7"></a>s_seq &lt;-<span class="st"> </span><span class="kw">quantile</span>(<span class="kw">dist</span>(smap_bc),<span class="kw">c</span>(<span class="fl">0.1</span><span class="op">*</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>)))</span>
<span id="cb13-8"><a href="#cb13-8"></a></span>
<span id="cb13-9"><a href="#cb13-9"></a>nei_eff &lt;-<span class="st"> </span><span class="kw">sim_nei_qtl</span>(genoprobs_bc, <span class="dt">a2=</span><span class="fl">0.3</span>, <span class="dt">d2=</span><span class="op">-</span><span class="fl">0.3</span>, </span>
<span id="cb13-10"><a href="#cb13-10"></a>                       <span class="dt">smap=</span>smap_bc, </span>
<span id="cb13-11"><a href="#cb13-11"></a>                       <span class="dt">scale=</span>s_seq[<span class="dv">1</span>], <span class="dt">n_QTL=</span><span class="dv">1</span>)</span>
<span id="cb13-12"><a href="#cb13-12"></a></span>
<span id="cb13-13"><a href="#cb13-13"></a>pve_bc &lt;-<span class="st"> </span><span class="kw">calc_pve</span>(<span class="dt">genoprobs=</span>genoprobs_bc,</span>
<span id="cb13-14"><a href="#cb13-14"></a>                   <span class="dt">pheno=</span>nei_eff<span class="op">$</span>nei_y,</span>
<span id="cb13-15"><a href="#cb13-15"></a>                   <span class="dt">smap=</span>smap_bc, <span class="dt">s_seq=</span>s_seq[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>],</span>
<span id="cb13-16"><a href="#cb13-16"></a>                   <span class="dt">addcovar=</span><span class="kw">as.matrix</span>(<span class="kw">cbind</span>(fake_bc<span class="op">$</span>pheno<span class="op">$</span>sex,fake_bc<span class="op">$</span>pheno<span class="op">$</span>age)),</span>
<span id="cb13-17"><a href="#cb13-17"></a>                   <span class="dt">fig=</span><span class="ot">FALSE</span>)</span>
<span id="cb13-18"><a href="#cb13-18"></a><span class="co">#&gt; scale = 19.256</span></span>
<span id="cb13-19"><a href="#cb13-19"></a><span class="co">#&gt; scale = 28.487</span></span>
<span id="cb13-20"><a href="#cb13-20"></a><span class="co">#&gt; scale = 36.266</span></span>
<span id="cb13-21"><a href="#cb13-21"></a><span class="co">#&gt; scale = 43.479</span></span>
<span id="cb13-22"><a href="#cb13-22"></a><span class="co">#&gt; scale = 50.618</span></span>
<span id="cb13-23"><a href="#cb13-23"></a>    </span>
<span id="cb13-24"><a href="#cb13-24"></a>deltaPVE &lt;-<span class="st"> </span>pve_bc[,<span class="dv">2</span>] <span class="op">-</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,pve_bc[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,<span class="dv">2</span>])</span>
<span id="cb13-25"><a href="#cb13-25"></a><span class="co">#&gt; Warning in pve_bc[, 2] - c(0, pve_bc[1:4, 2]): 長いオブジェクトの長さが短いオブ</span></span>
<span id="cb13-26"><a href="#cb13-26"></a><span class="co">#&gt; ジェクトの長さの倍数になっていません</span></span>
<span id="cb13-27"><a href="#cb13-27"></a>argmax_s &lt;-<span class="st"> </span>s_seq[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>][deltaPVE<span class="op">==</span><span class="kw">max</span>(deltaPVE)]</span>
<span id="cb13-28"><a href="#cb13-28"></a>    </span>
<span id="cb13-29"><a href="#cb13-29"></a>scan_bc &lt;-<span class="st"> </span><span class="kw">scan_neighbor</span>(<span class="dt">genoprobs=</span>genoprobs_bc,</span>
<span id="cb13-30"><a href="#cb13-30"></a>                         <span class="dt">pheno=</span>nei_eff<span class="op">$</span>nei_y,</span>
<span id="cb13-31"><a href="#cb13-31"></a>                         <span class="dt">smap=</span>smap_bc, <span class="dt">scale=</span>argmax_s,</span>
<span id="cb13-32"><a href="#cb13-32"></a>                         <span class="dt">addcovar=</span><span class="kw">as.matrix</span>(<span class="kw">cbind</span>(fake_bc<span class="op">$</span>pheno<span class="op">$</span>sex,fake_bc<span class="op">$</span>pheno<span class="op">$</span>age))</span>
<span id="cb13-33"><a href="#cb13-33"></a>                         )</span>
<span id="cb13-34"><a href="#cb13-34"></a></span>
<span id="cb13-35"><a href="#cb13-35"></a><span class="kw">plot_nei</span>(scan_bc)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="references" class="section level2">
<h2>References</h2>
<ul>
<li>Broman KW, Wu H, Sen S, Churchill GA. 2003. R/qtl: QTL mapping in experimental crosses. Bioinformatics 19: 889-890.</li>
<li>Broman KW, Sen S, 2009. Single-QTL analysis, In: A guide to QTL mapping with R/qtl. Springer New York, New York, NY, pp. 75-133.</li>
<li>Chen H, Wang C, Conomos M. et al. 2016. Control for population structure and relatedness for binary traits in genetic association studies via logistic mixed models. The American Journal of Human Genetics 98: 653-666.</li>
<li>Faraway JJ. 2016. Extending the linear model with R: generalized linear, mixed effects and nonparametric regression models. CRC press.</li>
<li>Haley CS, Knott SA. 1992. A simple regression method for mapping quantitative trait loci in line crosses using flanking markers. Heredity 69: 315-324.</li>
<li>Jansen RC. 1993. Interval mapping of multiple quantitative trait loci. Genetics 135: 205-211.</li>
<li>Perdry H, Dandine-Roulland C. 2020. gaston: Genetic Data Handling (QC, GRM, LD, PCA) &amp; Linear Mixed Models. R package version 1.5.6. <a href="https://CRAN.R-project.org/package=gaston" class="uri">https://CRAN.R-project.org/package=gaston</a></li>
<li>Sato Y, Takeda K, Nagano AJ. 2020. Neighbor QTL: an interval mapping method for quantitative trait loci underlying neighbor effects. bioRxiv <a href="https://doi.org/10.1101/2020.05.20.089474" class="uri">https://doi.org/10.1101/2020.05.20.089474</a></li>
<li>Wilson IW, Schiff CL, Hughes DE, Somerville SC. 2001. Quantitative trait loci analysis of powdery mildew disease resistance in the <em>Arabidopsis thaliana</em> accession kashmir-1. Genetics 158: 1301-1309.</li>
</ul>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
