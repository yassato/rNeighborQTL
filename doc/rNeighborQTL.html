<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>rNeighborQTL</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">rNeighborQTL</h1>



<div id="overview" class="section level2">
<h2>Overview</h2>
<p>
The “rNeighborQTL” package includes core functions to perform QTL mapping of neighbor effects. Taking conditional genotype probabilities from the “R/qtl2” package (Broman et al. 2019), the “scan_neighbor()” calculates neighbor genotypic identity and performs interval mapping of neighbor QTL effects. The neighbor QTL requires spatial information, namely individual positions along x-axis and y-axis, in addition to the genotype and phenotype data.
</p>
</div>
<div id="input-files" class="section level2">
<h2>Input files</h2>
<p>
First of all, let us prepare input data using the “R/qtl” or “R/qtl2” package (Broman et al. 2003; Broman et al. 2019). Here is an example to import .csv files into a ‘cross’ object with “R/qtl” package, and covert it into a ‘cross2’ object with “R/qtl2” package. In this example, we import insect herbivory data on Col x Kas recombinant inbred lines (RILs) of <em>Arabidopsis thaliana</em> (Wilson et al. 2001; Sato, Takeda &amp; Nagano unpublished), and subsequently calculate conditional self-genotype probabilities.
</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>colkas &lt;-<span class="st"> </span>qtl<span class="op">::</span><span class="kw">read.cross</span>(<span class="dt">format=</span><span class="st">&quot;csvs&quot;</span>,<span class="dt">dir=</span><span class="st">&quot;../inst&quot;</span>,</span>
<span id="cb1-2"><a href="#cb1-2"></a>                    <span class="dt">genfile=</span><span class="st">&quot;ColKas_geno.csv&quot;</span>,</span>
<span id="cb1-3"><a href="#cb1-3"></a>                    <span class="dt">phefile =</span> <span class="st">&quot;ColKas_pheno.csv&quot;</span>,</span>
<span id="cb1-4"><a href="#cb1-4"></a>                    <span class="dt">na.strings =</span> <span class="kw">c</span>(<span class="st">&quot;_&quot;</span>), <span class="dt">estimate.map=</span><span class="ot">TRUE</span>, <span class="dt">crosstype =</span> <span class="st">&quot;riself&quot;</span>)</span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="co">#&gt;  --Read the following data:</span></span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="co">#&gt;   126  individuals</span></span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="co">#&gt;   26  markers</span></span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="co">#&gt;   10  phenotypes</span></span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="co">#&gt;  --Estimating genetic map</span></span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="co">#&gt;  --Cross type: riself</span></span>
<span id="cb1-11"><a href="#cb1-11"></a>colkas &lt;-<span class="st"> </span>qtl2<span class="op">::</span><span class="kw">convert2cross2</span>(colkas)</span>
<span id="cb1-12"><a href="#cb1-12"></a></span>
<span id="cb1-13"><a href="#cb1-13"></a>gmap_colkas &lt;-<span class="st"> </span>qtl2<span class="op">::</span><span class="kw">insert_pseudomarkers</span>(colkas<span class="op">$</span>gmap, <span class="dt">step=</span><span class="dv">2</span>)</span>
<span id="cb1-14"><a href="#cb1-14"></a>colkas_genoprob &lt;-<span class="st"> </span>qtl2<span class="op">::</span><span class="kw">calc_genoprob</span>(colkas,gmap_colkas)</span></code></pre></div>
</div>
<div id="proportion-of-variation-explained-by-neighbor-effects" class="section level2">
<h2>Proportion of variation explained by neighbor effects</h2>
<p>
Prior to the genome scan, we estimate the ‘scale’ argument. Using linear mixed models implemented in “gaston” package (Perdry &amp; Dandine-Roulland 2020), the “calc_pve()” computes proportion of phenotypic variation (PVE) by neighbor effects for a series of spatial scales. Based on the PVE, we calculate <span class="math inline">\(\Delta\)</span>PVE metric and seek the scale <span class="math inline">\(s\)</span> that gives an argument for the maximum of <span class="math inline">\(\Delta\)</span>PVE.
</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="kw">library</span>(rNeighborQTL)</span>
<span id="cb2-2"><a href="#cb2-2"></a>x &lt;-<span class="st"> </span>colkas<span class="op">$</span>pheno[,<span class="dv">2</span>]</span>
<span id="cb2-3"><a href="#cb2-3"></a>y &lt;-<span class="st"> </span>colkas<span class="op">$</span>pheno[,<span class="dv">3</span>]</span>
<span id="cb2-4"><a href="#cb2-4"></a>smap_colkas &lt;-<span class="st"> </span><span class="kw">data.frame</span>(x,y)</span>
<span id="cb2-5"><a href="#cb2-5"></a></span>
<span id="cb2-6"><a href="#cb2-6"></a>s_seq &lt;-<span class="st"> </span><span class="kw">quantile</span>(<span class="kw">dist</span>(smap_colkas),<span class="kw">c</span>(<span class="fl">0.1</span><span class="op">*</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>)))</span>
<span id="cb2-7"><a href="#cb2-7"></a>colkas_pve &lt;-<span class="st"> </span><span class="kw">calc_pve</span>(<span class="dt">genoprobs=</span>colkas_genoprob,</span>
<span id="cb2-8"><a href="#cb2-8"></a>                       <span class="dt">pheno=</span><span class="kw">log</span>(colkas<span class="op">$</span>pheno[,<span class="dv">4</span>]<span class="op">+</span><span class="dv">1</span>),</span>
<span id="cb2-9"><a href="#cb2-9"></a>                       <span class="dt">gmap=</span>gmap_colkas, <span class="dt">contrasts=</span><span class="kw">c</span>(<span class="ot">TRUE</span>,<span class="ot">FALSE</span>,<span class="ot">TRUE</span>),</span>
<span id="cb2-10"><a href="#cb2-10"></a>                       <span class="dt">addcovar=</span>colkas<span class="op">$</span>pheno[,<span class="dv">6</span><span class="op">:</span><span class="dv">8</span>], </span>
<span id="cb2-11"><a href="#cb2-11"></a>                       <span class="dt">smap=</span>smap_colkas, <span class="dt">s_seq=</span>s_seq</span>
<span id="cb2-12"><a href="#cb2-12"></a>                       )</span>
<span id="cb2-13"><a href="#cb2-13"></a><span class="co">#&gt; scale = 2.236</span></span>
<span id="cb2-14"><a href="#cb2-14"></a><span class="co">#&gt; scale = 3.162</span></span>
<span id="cb2-15"><a href="#cb2-15"></a><span class="co">#&gt; scale = 4.243</span></span>
<span id="cb2-16"><a href="#cb2-16"></a><span class="co">#&gt; scale = 5.099</span></span>
<span id="cb2-17"><a href="#cb2-17"></a><span class="co">#&gt; scale = 6</span></span>
<span id="cb2-18"><a href="#cb2-18"></a><span class="co">#&gt; scale = 7</span></span>
<span id="cb2-19"><a href="#cb2-19"></a><span class="co">#&gt; scale = 7.81</span></span>
<span id="cb2-20"><a href="#cb2-20"></a><span class="co">#&gt; scale = 8.602</span></span>
<span id="cb2-21"><a href="#cb2-21"></a><span class="co">#&gt; scale = 10.05</span></span>
<span id="cb2-22"><a href="#cb2-22"></a><span class="co">#&gt; scale = 15</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="estimation-of-qtl-effects" class="section level2">
<h2>Estimation of QTL effects</h2>
<p>
Then, the deviation coefficients <span class="math inline">\(a\)</span> and <span class="math inline">\(d\)</span> are estimated using a linear regression on the genotype probabilities, also known as Haley-Knott regression (Haley &amp; Knott 1992). The “eff_neighbor()” estimates the coefficients for self and neighbor effects, and plots the results as follows.
</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>colkas_eff &lt;-<span class="st"> </span><span class="kw">eff_neighbor</span>(<span class="dt">genoprobs=</span>colkas_genoprob,</span>
<span id="cb3-2"><a href="#cb3-2"></a>                           <span class="dt">pheno=</span><span class="kw">log</span>(colkas<span class="op">$</span>pheno[,<span class="dv">4</span>]<span class="op">+</span><span class="dv">1</span>),</span>
<span id="cb3-3"><a href="#cb3-3"></a>                           <span class="dt">gmap=</span>gmap_colkas, <span class="dt">contrasts=</span><span class="kw">c</span>(<span class="ot">TRUE</span>,<span class="ot">FALSE</span>,<span class="ot">TRUE</span>),</span>
<span id="cb3-4"><a href="#cb3-4"></a>                           <span class="dt">smap=</span>smap_colkas, <span class="dt">scale=</span><span class="dv">7</span>,</span>
<span id="cb3-5"><a href="#cb3-5"></a>                           <span class="dt">addcovar=</span>colkas<span class="op">$</span>pheno[,<span class="dv">6</span><span class="op">:</span><span class="dv">8</span>]</span>
<span id="cb3-6"><a href="#cb3-6"></a>                           )</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="lod-score" class="section level2">
<h2>LOD score</h2>
<p>
Lastly, we perform a genome scan to obtain LOD scores for neighbor QTL effects. The “scan_neighbor()” calculates likelihoods using the estimated QTL effects through the “eff_neighbor()”. The results are drawn by “plot_nei()”.
</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>colkas_scan &lt;-<span class="st"> </span><span class="kw">scan_neighbor</span>(<span class="dt">genoprobs=</span>colkas_genoprob, </span>
<span id="cb4-2"><a href="#cb4-2"></a>                             <span class="dt">pheno=</span><span class="kw">log</span>(colkas<span class="op">$</span>pheno[,<span class="dv">4</span>]<span class="op">+</span><span class="dv">1</span>),</span>
<span id="cb4-3"><a href="#cb4-3"></a>                             <span class="dt">gmap=</span>gmap_colkas, <span class="dt">contrasts=</span><span class="kw">c</span>(<span class="ot">TRUE</span>,<span class="ot">FALSE</span>,<span class="ot">TRUE</span>),</span>
<span id="cb4-4"><a href="#cb4-4"></a>                             <span class="dt">smap=</span>smap_colkas, <span class="dt">scale=</span><span class="dv">7</span>, </span>
<span id="cb4-5"><a href="#cb4-5"></a>                             <span class="dt">addcovar=</span>colkas<span class="op">$</span>pheno[,<span class="dv">6</span><span class="op">:</span><span class="dv">8</span>]</span>
<span id="cb4-6"><a href="#cb4-6"></a>                             )</span>
<span id="cb4-7"><a href="#cb4-7"></a><span class="kw">plot_nei</span>(colkas_scan)</span></code></pre></div>
<img src="data:image/png;base64,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" /><!-- -->
<p>
In addition to the genome scan, we can perform permutation tests to estimate a genome-wide significance level. Such permutation tests better account data structure, but require much computational time. Here is a handful example with 99-times permutations.
</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>colkas_perm &lt;-<span class="st"> </span><span class="kw">perm_neighbor</span>(<span class="dt">genoprobs=</span>colkas_genoprob, <span class="dt">pheno=</span><span class="kw">log</span>(colkas<span class="op">$</span>pheno[,<span class="dv">4</span>]<span class="op">+</span><span class="dv">1</span>),</span>
<span id="cb5-2"><a href="#cb5-2"></a>                            <span class="dt">gmap=</span>gmap_colkas, <span class="dt">contrasts=</span><span class="kw">c</span>(<span class="ot">TRUE</span>,<span class="ot">FALSE</span>,<span class="ot">TRUE</span>),</span>
<span id="cb5-3"><a href="#cb5-3"></a>                            <span class="dt">smap=</span>smap_colkas, <span class="dt">scale=</span><span class="dv">7</span>,</span>
<span id="cb5-4"><a href="#cb5-4"></a>                            <span class="dt">addcovar=</span>colkas<span class="op">$</span>pheno[,<span class="dv">6</span><span class="op">:</span><span class="dv">8</span>],</span>
<span id="cb5-5"><a href="#cb5-5"></a>                            <span class="dt">times=</span><span class="dv">99</span>, <span class="dt">p_val=</span><span class="kw">c</span>(<span class="fl">0.1</span>,<span class="fl">0.05</span>,<span class="fl">0.01</span>))</span>
<span id="cb5-6"><a href="#cb5-6"></a><span class="kw">print</span>(colkas_perm)</span>
<span id="cb5-7"><a href="#cb5-7"></a><span class="co">#&gt;      90%      95%      99% </span></span>
<span id="cb5-8"><a href="#cb5-8"></a><span class="co">#&gt; 2.167621 2.605381 2.857399</span></span></code></pre></div>
</div>
<div id="extensions" class="section level2">
<h2>Extensions</h2>
<div id="self-genotype-effects" class="section level3">
<h3><em>1. Self-genotype effects</em></h3>
<p>
The “scan_neighbor()” at the same time provides LOD scores for self QTL effects. This gives the same results as standard QTL mapping by “qtl2::scan1()”.
</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="kw">plot_nei</span>(colkas_scan, <span class="dt">type=</span><span class="st">&quot;self&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>colkas_scan1 &lt;-<span class="st"> </span>qtl2<span class="op">::</span><span class="kw">scan1</span>(colkas_genoprob,<span class="dt">pheno=</span><span class="kw">log</span>(colkas<span class="op">$</span>pheno[,<span class="dv">4</span>]<span class="op">+</span><span class="dv">1</span>),<span class="dt">addcovar=</span>colkas<span class="op">$</span>pheno[,<span class="dv">6</span><span class="op">:</span><span class="dv">8</span>])</span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="kw">plot</span>(colkas_scan1, <span class="dt">map=</span>gmap_colkas)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="composite-interval-mapping" class="section level3">
<h3><em>2. Composite interval mapping</em></h3>
<p>
The “addQTL” argument allows us to include non-focal QTLs as covariates. This option enables composite interval mapping (Jensen et al. 1993) that considers additional QTL effects. Here is an example using the Col x Kas herbivory data, with the nga8 marker considered a covariate.
</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>colkas_cim &lt;-<span class="st"> </span><span class="kw">scan_neighbor</span>(<span class="dt">genoprobs=</span>colkas_genoprob, <span class="dt">pheno=</span><span class="kw">log</span>(colkas<span class="op">$</span>pheno[,<span class="dv">4</span>]<span class="op">+</span><span class="dv">1</span>),</span>
<span id="cb8-2"><a href="#cb8-2"></a>                            <span class="dt">gmap=</span>gmap_colkas, <span class="dt">contrasts=</span><span class="kw">c</span>(<span class="ot">TRUE</span>,<span class="ot">FALSE</span>,<span class="ot">TRUE</span>),</span>
<span id="cb8-3"><a href="#cb8-3"></a>                            <span class="dt">smap=</span>smap_colkas, <span class="dt">scale=</span><span class="dv">7</span>,</span>
<span id="cb8-4"><a href="#cb8-4"></a>                            <span class="dt">addcovar=</span>colkas<span class="op">$</span>pheno[,<span class="dv">6</span><span class="op">:</span><span class="dv">8</span>],</span>
<span id="cb8-5"><a href="#cb8-5"></a>                            <span class="dt">addQTL=</span><span class="st">&quot;nga8&quot;</span></span>
<span id="cb8-6"><a href="#cb8-6"></a>                            )</span>
<span id="cb8-7"><a href="#cb8-7"></a><span class="kw">plot_nei</span>(colkas_cim)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="epistasis-in-neighbor-qtl-effects" class="section level3">
<h3><em>3. Epistasis in neighbor QTL effects</em></h3>
<p>
For the analysis of epistasis, the “int_neighbor()” calculate LOD score of two-way interactions between a focal marker and the others. Here is an example for the ‘nga8’ marker in the Col x Kas herbivory data.
</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>colkas_int &lt;-<span class="st"> </span><span class="kw">int_neighbor</span>(<span class="dt">genoprobs=</span>colkas_genoprob, </span>
<span id="cb9-2"><a href="#cb9-2"></a>                           <span class="dt">pheno=</span><span class="kw">log</span>(colkas<span class="op">$</span>pheno[,<span class="dv">4</span>]<span class="op">+</span><span class="dv">1</span>), </span>
<span id="cb9-3"><a href="#cb9-3"></a>                           <span class="dt">gmap=</span>gmap_colkas, <span class="dt">contrasts=</span><span class="kw">c</span>(<span class="ot">TRUE</span>,<span class="ot">FALSE</span>,<span class="ot">TRUE</span>),</span>
<span id="cb9-4"><a href="#cb9-4"></a>                           <span class="dt">smap=</span>smap_colkas, <span class="dt">scale=</span><span class="dv">7</span>, </span>
<span id="cb9-5"><a href="#cb9-5"></a>                           <span class="dt">addcovar=</span>colkas<span class="op">$</span>pheno[,<span class="dv">6</span><span class="op">:</span><span class="dv">8</span>], </span>
<span id="cb9-6"><a href="#cb9-6"></a>                           <span class="dt">addQTL=</span><span class="st">&quot;nga8&quot;</span>, <span class="dt">intQTL=</span><span class="st">&quot;nga8&quot;</span></span>
<span id="cb9-7"><a href="#cb9-7"></a>                           )</span>
<span id="cb9-8"><a href="#cb9-8"></a><span class="kw">plot_nei</span>(colkas_int, <span class="dt">type=</span><span class="st">&quot;int&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="binary-traits" class="section level3">
<h3><em>4. Binary traits</em></h3>
<p>
The “response” argument allows us to analyze “binary” phenotypes as well as “quantitative” traits. This argument calls logistic (mixed) models internally (Faraway 2016; Chen et al. 2016). The “calc_pve()” yields the ratio of phenotypic variation explained (RVE) by neighbor effects as RVE<sub>nei</sub> =<span class="math inline">\(\sigma^2_2/\sigma^2_1\)</span> when “binary” traits are analyzed, because the logistic mixed model does not compute <span class="math inline">\(\sigma^2_e\)</span> (Perdry &amp; Dandine-Roulland 2020). Here is an example for the analysis of the presence or absence of bolting in Col x Kas RILs.
</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>s_seq &lt;-<span class="st"> </span><span class="kw">quantile</span>(<span class="kw">dist</span>(smap_colkas),<span class="kw">c</span>(<span class="fl">0.1</span><span class="op">*</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>)))</span>
<span id="cb10-2"><a href="#cb10-2"></a>colkas_pveBin &lt;-<span class="st"> </span><span class="kw">calc_pve</span>(<span class="dt">genoprobs=</span>colkas_genoprob, <span class="dt">pheno=</span>colkas<span class="op">$</span>pheno[,<span class="dv">6</span>],</span>
<span id="cb10-3"><a href="#cb10-3"></a>                       <span class="dt">gmap=</span>gmap_colkas, <span class="dt">contrasts=</span><span class="kw">c</span>(<span class="ot">TRUE</span>,<span class="ot">FALSE</span>,<span class="ot">TRUE</span>),</span>
<span id="cb10-4"><a href="#cb10-4"></a>                       <span class="dt">smap=</span>smap_colkas, <span class="dt">s_seq=</span>s_seq,</span>
<span id="cb10-5"><a href="#cb10-5"></a>                       <span class="dt">response=</span><span class="st">&quot;binary&quot;</span>, <span class="dt">addcovar=</span>colkas<span class="op">$</span>pheno[,<span class="dv">7</span><span class="op">:</span><span class="dv">8</span>], <span class="dt">fig=</span><span class="ot">TRUE</span></span>
<span id="cb10-6"><a href="#cb10-6"></a>                       )</span>
<span id="cb10-7"><a href="#cb10-7"></a><span class="co">#&gt; scale = 2.236</span></span>
<span id="cb10-8"><a href="#cb10-8"></a><span class="co">#&gt; scale = 3.162</span></span>
<span id="cb10-9"><a href="#cb10-9"></a><span class="co">#&gt; scale = 4.243</span></span>
<span id="cb10-10"><a href="#cb10-10"></a><span class="co">#&gt; scale = 5.099</span></span>
<span id="cb10-11"><a href="#cb10-11"></a><span class="co">#&gt; scale = 6</span></span>
<span id="cb10-12"><a href="#cb10-12"></a><span class="co">#&gt; scale = 7</span></span>
<span id="cb10-13"><a href="#cb10-13"></a><span class="co">#&gt; scale = 7.81</span></span>
<span id="cb10-14"><a href="#cb10-14"></a><span class="co">#&gt; scale = 8.602</span></span>
<span id="cb10-15"><a href="#cb10-15"></a><span class="co">#&gt; scale = 10.05</span></span>
<span id="cb10-16"><a href="#cb10-16"></a><span class="co">#&gt; scale = 15</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a></span>
<span id="cb11-2"><a href="#cb11-2"></a>colkas_scanBin &lt;-<span class="st"> </span><span class="kw">scan_neighbor</span>(<span class="dt">genoprobs=</span>colkas_genoprob, <span class="dt">pheno=</span>colkas<span class="op">$</span>pheno[,<span class="dv">6</span>],</span>
<span id="cb11-3"><a href="#cb11-3"></a>                                <span class="dt">gmap=</span>gmap_colkas, <span class="dt">contrasts=</span><span class="kw">c</span>(<span class="ot">TRUE</span>,<span class="ot">FALSE</span>,<span class="ot">TRUE</span>),</span>
<span id="cb11-4"><a href="#cb11-4"></a>                                smap_colkas, <span class="dt">scale=</span><span class="fl">2.24</span>,</span>
<span id="cb11-5"><a href="#cb11-5"></a>                                <span class="dt">addcovar=</span>colkas<span class="op">$</span>pheno[,<span class="dv">7</span><span class="op">:</span><span class="dv">8</span>], <span class="dt">response=</span><span class="st">&quot;binary&quot;</span></span>
<span id="cb11-6"><a href="#cb11-6"></a>                                )</span>
<span id="cb11-7"><a href="#cb11-7"></a></span>
<span id="cb11-8"><a href="#cb11-8"></a><span class="kw">plot_nei</span>(colkas_scanBin)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="crossing-design" class="section level3">
<h3><em>5. Crossing design</em></h3>
<p>
The neighbor QTL package is able to handle AB heterozygotes. It also works even when there are only AA or AB genotypes. However, sex chromosomes are not supported currently, and should be excluded before the genome scan. This is a simulation using F2 or backcross lines implemented in the “R/qtl” package.
</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="co">#demo using F2</span></span>
<span id="cb12-2"><a href="#cb12-2"></a><span class="kw">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb12-3"><a href="#cb12-3"></a><span class="kw">data</span>(<span class="st">&quot;fake.f2&quot;</span>,<span class="dt">package=</span><span class="st">&quot;qtl&quot;</span>)</span>
<span id="cb12-4"><a href="#cb12-4"></a>fake_f2 &lt;-<span class="st"> </span>qtl2<span class="op">::</span><span class="kw">convert2cross2</span>(fake.f2)</span>
<span id="cb12-5"><a href="#cb12-5"></a>fake_f2 &lt;-<span class="st"> </span><span class="kw">subset</span>(fake_f2,<span class="dt">chr=</span><span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">19</span>))</span>
<span id="cb12-6"><a href="#cb12-6"></a>smap_f2 &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">runif</span>(qtl2<span class="op">::</span><span class="kw">n_ind</span>(fake_f2),<span class="dv">1</span>,<span class="dv">100</span>),<span class="kw">runif</span>(qtl2<span class="op">::</span><span class="kw">n_ind</span>(fake_f2),<span class="dv">1</span>,<span class="dv">100</span>))</span>
<span id="cb12-7"><a href="#cb12-7"></a>gmap_f2 &lt;-<span class="st"> </span>qtl2<span class="op">::</span><span class="kw">insert_pseudomarkers</span>(fake_f2<span class="op">$</span>gmap, <span class="dt">step=</span><span class="dv">2</span>)</span>
<span id="cb12-8"><a href="#cb12-8"></a>genoprobs_f2 &lt;-<span class="st"> </span>qtl2<span class="op">::</span><span class="kw">calc_genoprob</span>(fake_f2,gmap_f2)</span>
<span id="cb12-9"><a href="#cb12-9"></a>s_seq &lt;-<span class="st"> </span><span class="kw">quantile</span>(<span class="kw">dist</span>(smap_f2),<span class="kw">c</span>(<span class="fl">0.1</span><span class="op">*</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>)))</span>
<span id="cb12-10"><a href="#cb12-10"></a></span>
<span id="cb12-11"><a href="#cb12-11"></a>nei_eff &lt;-<span class="st"> </span><span class="kw">sim_nei_qtl</span>(genoprobs_f2, gmap_f2, <span class="dt">a2=</span><span class="fl">0.5</span>, <span class="dt">d2=</span><span class="fl">0.5</span>, </span>
<span id="cb12-12"><a href="#cb12-12"></a>                       <span class="dt">contrasts=</span><span class="kw">c</span>(<span class="ot">TRUE</span>,<span class="ot">TRUE</span>,<span class="ot">TRUE</span>), <span class="dt">smap=</span>smap_f2, </span>
<span id="cb12-13"><a href="#cb12-13"></a>                       <span class="dt">scale=</span>s_seq[<span class="dv">1</span>], <span class="dt">n_QTL=</span><span class="dv">1</span>)</span>
<span id="cb12-14"><a href="#cb12-14"></a></span>
<span id="cb12-15"><a href="#cb12-15"></a>pve_f2 &lt;-<span class="st"> </span><span class="kw">calc_pve</span>(<span class="dt">genoprobs=</span>genoprobs_f2,</span>
<span id="cb12-16"><a href="#cb12-16"></a>                       <span class="dt">pheno=</span>nei_eff<span class="op">$</span>nei_y,</span>
<span id="cb12-17"><a href="#cb12-17"></a>                       <span class="dt">gmap=</span>gmap_f2, <span class="dt">contrasts=</span><span class="kw">c</span>(<span class="ot">TRUE</span>,<span class="ot">TRUE</span>,<span class="ot">TRUE</span>),</span>
<span id="cb12-18"><a href="#cb12-18"></a>                       <span class="dt">smap=</span>smap_f2, <span class="dt">s_seq=</span>s_seq[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>],</span>
<span id="cb12-19"><a href="#cb12-19"></a>                       <span class="dt">addcovar=</span><span class="kw">as.matrix</span>(fake_f2<span class="op">$</span>covar), <span class="dt">fig=</span><span class="ot">FALSE</span>)</span>
<span id="cb12-20"><a href="#cb12-20"></a><span class="co">#&gt; scale = 19.368</span></span>
<span id="cb12-21"><a href="#cb12-21"></a><span class="co">#&gt; scale = 28.245</span></span>
<span id="cb12-22"><a href="#cb12-22"></a><span class="co">#&gt; scale = 35.695</span></span>
<span id="cb12-23"><a href="#cb12-23"></a><span class="co">#&gt; scale = 42.909</span></span>
<span id="cb12-24"><a href="#cb12-24"></a><span class="co">#&gt; scale = 49.961</span></span>
<span id="cb12-25"><a href="#cb12-25"></a>    </span>
<span id="cb12-26"><a href="#cb12-26"></a>deltaPVE &lt;-<span class="st"> </span>pve_f2[,<span class="dv">2</span>] <span class="op">-</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,pve_f2[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,<span class="dv">2</span>])</span>
<span id="cb12-27"><a href="#cb12-27"></a>argmax_s &lt;-<span class="st"> </span>s_seq[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>][deltaPVE<span class="op">==</span><span class="kw">max</span>(deltaPVE)]</span>
<span id="cb12-28"><a href="#cb12-28"></a>    </span>
<span id="cb12-29"><a href="#cb12-29"></a>scan_f2 &lt;-<span class="st"> </span><span class="kw">scan_neighbor</span>(<span class="dt">genoprobs=</span>genoprobs_f2,</span>
<span id="cb12-30"><a href="#cb12-30"></a>                         <span class="dt">pheno=</span>nei_eff<span class="op">$</span>nei_y,</span>
<span id="cb12-31"><a href="#cb12-31"></a>                         <span class="dt">gmap=</span>gmap_f2, <span class="dt">contrasts=</span><span class="kw">c</span>(<span class="ot">TRUE</span>,<span class="ot">TRUE</span>,<span class="ot">TRUE</span>),</span>
<span id="cb12-32"><a href="#cb12-32"></a>                         <span class="dt">smap=</span>smap_f2, <span class="dt">scale=</span>argmax_s,</span>
<span id="cb12-33"><a href="#cb12-33"></a>                         <span class="dt">addcovar=</span><span class="kw">as.matrix</span>(fake_f2<span class="op">$</span>covar)</span>
<span id="cb12-34"><a href="#cb12-34"></a>                         )</span>
<span id="cb12-35"><a href="#cb12-35"></a>    </span>
<span id="cb12-36"><a href="#cb12-36"></a><span class="kw">plot_nei</span>(scan_f2)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="co">#backcross lines</span></span>
<span id="cb13-2"><a href="#cb13-2"></a><span class="kw">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb13-3"><a href="#cb13-3"></a><span class="kw">data</span>(<span class="st">&quot;fake.bc&quot;</span>,<span class="dt">package=</span><span class="st">&quot;qtl&quot;</span>)</span>
<span id="cb13-4"><a href="#cb13-4"></a>fake_bc &lt;-<span class="st"> </span>qtl2<span class="op">::</span><span class="kw">convert2cross2</span>(fake.bc)</span>
<span id="cb13-5"><a href="#cb13-5"></a>fake_bc &lt;-<span class="st"> </span><span class="kw">subset</span>(fake_bc,<span class="dt">chr=</span><span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">19</span>))</span>
<span id="cb13-6"><a href="#cb13-6"></a>smap_bc &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="kw">runif</span>(qtl2<span class="op">::</span><span class="kw">n_ind</span>(fake_bc),<span class="dv">1</span>,<span class="dv">100</span>),<span class="kw">runif</span>(qtl2<span class="op">::</span><span class="kw">n_ind</span>(fake_bc),<span class="dv">1</span>,<span class="dv">100</span>))</span>
<span id="cb13-7"><a href="#cb13-7"></a>s_seq &lt;-<span class="st"> </span><span class="kw">quantile</span>(<span class="kw">dist</span>(smap_bc),<span class="kw">c</span>(<span class="fl">0.1</span><span class="op">*</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>)))</span>
<span id="cb13-8"><a href="#cb13-8"></a>gmap_bc &lt;-<span class="st"> </span>qtl2<span class="op">::</span><span class="kw">insert_pseudomarkers</span>(fake_bc<span class="op">$</span>gmap, <span class="dt">step=</span><span class="dv">2</span>)</span>
<span id="cb13-9"><a href="#cb13-9"></a>genoprobs_bc &lt;-<span class="st"> </span>qtl2<span class="op">::</span><span class="kw">calc_genoprob</span>(fake_bc,gmap_bc)</span>
<span id="cb13-10"><a href="#cb13-10"></a></span>
<span id="cb13-11"><a href="#cb13-11"></a>nei_eff &lt;-<span class="st"> </span><span class="kw">sim_nei_qtl</span>(genoprobs_bc, gmap_bc, <span class="dt">a2=</span><span class="fl">0.3</span>, <span class="dt">d2=</span><span class="op">-</span><span class="fl">0.3</span>, </span>
<span id="cb13-12"><a href="#cb13-12"></a>                       <span class="dt">contrasts=</span><span class="kw">c</span>(<span class="ot">TRUE</span>,<span class="ot">TRUE</span>,<span class="ot">FALSE</span>), <span class="dt">smap=</span>smap_bc, </span>
<span id="cb13-13"><a href="#cb13-13"></a>                       <span class="dt">scale=</span>s_seq[<span class="dv">1</span>], <span class="dt">n_QTL=</span><span class="dv">1</span>)</span>
<span id="cb13-14"><a href="#cb13-14"></a></span>
<span id="cb13-15"><a href="#cb13-15"></a>pve_bc &lt;-<span class="st"> </span><span class="kw">calc_pve</span>(<span class="dt">genoprobs=</span>genoprobs_bc,</span>
<span id="cb13-16"><a href="#cb13-16"></a>                       <span class="dt">pheno=</span>nei_eff<span class="op">$</span>nei_y,</span>
<span id="cb13-17"><a href="#cb13-17"></a>                       <span class="dt">gmap=</span>gmap_bc, <span class="dt">contrasts=</span><span class="kw">c</span>(<span class="ot">TRUE</span>,<span class="ot">TRUE</span>,<span class="ot">FALSE</span>),</span>
<span id="cb13-18"><a href="#cb13-18"></a>                       <span class="dt">smap=</span>smap_bc, <span class="dt">s_seq=</span>s_seq[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>],</span>
<span id="cb13-19"><a href="#cb13-19"></a>                       <span class="dt">addcovar=</span><span class="kw">as.matrix</span>(fake_bc<span class="op">$</span>covar), <span class="dt">fig=</span><span class="ot">FALSE</span>)</span>
<span id="cb13-20"><a href="#cb13-20"></a><span class="co">#&gt; scale = 19.256</span></span>
<span id="cb13-21"><a href="#cb13-21"></a><span class="co">#&gt; scale = 28.487</span></span>
<span id="cb13-22"><a href="#cb13-22"></a><span class="co">#&gt; scale = 36.266</span></span>
<span id="cb13-23"><a href="#cb13-23"></a><span class="co">#&gt; scale = 43.479</span></span>
<span id="cb13-24"><a href="#cb13-24"></a><span class="co">#&gt; scale = 50.618</span></span>
<span id="cb13-25"><a href="#cb13-25"></a>    </span>
<span id="cb13-26"><a href="#cb13-26"></a>deltaPVE &lt;-<span class="st"> </span>pve_bc[,<span class="dv">2</span>] <span class="op">-</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,pve_bc[<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>,<span class="dv">2</span>])</span>
<span id="cb13-27"><a href="#cb13-27"></a>argmax_s &lt;-<span class="st"> </span>s_seq[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>][deltaPVE<span class="op">==</span><span class="kw">max</span>(deltaPVE)]</span>
<span id="cb13-28"><a href="#cb13-28"></a>    </span>
<span id="cb13-29"><a href="#cb13-29"></a>scan_bc &lt;-<span class="st"> </span><span class="kw">scan_neighbor</span>(<span class="dt">genoprobs=</span>genoprobs_bc,</span>
<span id="cb13-30"><a href="#cb13-30"></a>                         <span class="dt">pheno=</span>nei_eff<span class="op">$</span>nei_y,</span>
<span id="cb13-31"><a href="#cb13-31"></a>                         <span class="dt">gmap=</span>gmap_bc, <span class="dt">contrasts=</span><span class="kw">c</span>(<span class="ot">TRUE</span>,<span class="ot">TRUE</span>,<span class="ot">FALSE</span>),</span>
<span id="cb13-32"><a href="#cb13-32"></a>                         <span class="dt">smap=</span>smap_bc, <span class="dt">scale=</span>argmax_s,</span>
<span id="cb13-33"><a href="#cb13-33"></a>                         <span class="dt">addcovar=</span><span class="kw">as.matrix</span>(fake_bc<span class="op">$</span>covar)</span>
<span id="cb13-34"><a href="#cb13-34"></a>                         )</span>
<span id="cb13-35"><a href="#cb13-35"></a></span>
<span id="cb13-36"><a href="#cb13-36"></a><span class="kw">plot_nei</span>(scan_bc)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="references" class="section level2">
<h2>References</h2>
<ul>
<li>Broman KW, Wu H, Sen S, Churchill GA. 2003. R/qtl: QTL mapping in experimental crosses. Bioinformatics 19: 889-890.</li>
<li>Broman KW, Sen S, 2009. Single-QTL analysis, In: A guide to QTL mapping with R/qtl. Springer New York, New York, NY, pp. 75-133.</li>
<li>Broman KW, Gatti DM, Simecek P, Furlotte NA, Prins P, Sen S, Yandell BS, Churchill GA. 2019. R/qtl2: Software for mapping quantitative trait loci with high-dimensional data and multiparent populations. Genetics 211: 495-502.</li>
<li>Chen H, Wang C, Conomos M. et al. 2016. Control for population structure and relatedness for binary traits in genetic association studies via logistic mixed models. The American Journal of Human Genetics 98: 653-666.</li>
<li>Faraway JJ. 2016. Extending the linear model with R: generalized linear, mixed effects and nonparametric regression models. CRC press.</li>
<li>Haley CS, Knott SA. 1992. A simple regression method for mapping quantitative trait loci in line crosses using flanking markers. Heredity 69: 315-324.</li>
<li>Jansen RC. 1993. Interval mapping of multiple quantitative trait loci. Genetics 135: 205-211.</li>
<li>Perdry H, Dandine-Roulland C. 2020. gaston: Genetic Data Handling (QC, GRM, LD, PCA) &amp; Linear Mixed Models. R package version 1.5.6. <a href="https://CRAN.R-project.org/package=gaston" class="uri">https://CRAN.R-project.org/package=gaston</a></li>
<li>Wilson IW, Schiff CL, Hughes DE, Somerville SC. 2001. Quantitative trait loci analysis of powdery mildew disease resistance in the <em>Arabidopsis thaliana</em> accession kashmir-1. Genetics 158: 1301-1309.</li>
</ul>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
